version: '3.8'

services:
  app:
    build: .
    container_name: gudang-sparepart-app
    working_dir: /var/www
    volumes: # For Deployment on My Zima OS Server
      - /DATA/AppData/gudang-sparepart:/var/www
      - /DATA/AppData/gudang-sparepart/storage/app:/var/www/storage/app
      - /DATA/AppData/gudang-sparepart/storage/logs:/var/www/storage/logs
      - /DATA/AppData/gudang-sparepart/vendor:/var/www/vendor
      - /DATA/AppData/gudang-sparepart/node_modules:/var/www/resources/js/node_modules
    ports:
      - '9090:9090' # PHP-FPM
      - '5173:5173' # Vite dev server (if needed)
    env_file:
      - .env
    depends_on:

    command: |
      sh -c "
        echo 'ðŸš€ Starting Gudang Sparepart...' &&
        php artisan config:cache &&
        php artisan route:cache &&
        php artisan view:cache &&
        php artisan storage:link &&
        php artisan migrate --force &&
        php artisan db:seed --force &&
        echo 'âœ… Migrations and seeding completed!' &&
        php-fpm
      "
